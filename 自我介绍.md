## 离职原因

    组织架构变动，直播技术组被拆分，带着业务分去了交易。拆分后一个月和交易的领导的管理方式和流程感觉不太合得来，交易对文档、流程等有极其严格的要求，稳定比按时交付更重要。

    我负责的各种直播间内的活动时效性很强，为了赶上时间节奏经常倒排期。同时和客户端合作较多，需要他们出新的 bridge 等场景由于版本覆盖率的问题，经常用客户端先进代码等方式。
    这样确实有风险，但是也没有其他的解决方式，我夹在产品和技术中间很难受。还有很多一起入职的同事都走了，我待了三年多，赔偿给的 n+2，算了一下感觉拿赔偿走人更合算

## 有啥希望公司提供的

    限制一下开会次数、长期稳定迭代的需求、想做由产品推动项目的C端

## 问面试官问题

    技术栈、团队规模、在做的事、

## 问 hr 问题

    啥时候发年终奖、第一次发工资是啥时候（北京的公积金4.8号能取出来，需要不在外地交公积金）

## gap 原因

    要离开北京 休息了几个月，女朋友江苏的，在这几个月内父母见面，打算定居在苏州。
    拿了25万赔偿不着急找工作，北京公积金4月8号能销户提出来，如果在其他地方交公积金就会自动转过去，所以希望3月份找工作。

## 难点、有成就感的事

    负责小红书每年直播组的双十一和春晚前端业务，搭建活动和营销方向的基础业务模型，保证活动需求快速上线和线上稳定性。
### 直播券
    背景：直播间券三年来一直在维护和迭代，主要做了两方面的改造，开发直播间通用券模型和优化券的速度。
    直播间开始尝试发券后发现效果很好，无论是ctr还是roi都明显超出其他营销手段。后来针对不同画像人群发了专属券，同一期间线上会存在多种大同小异的券。
#### 通用券模型
    为了降低开发和维护成本，创建了一个券的通用模版，里面包含了现有的和规划中的所有场景，包括单张/多张券、满减/折扣券、有效期是绝对值/相对值，是否需要完成任务才能领、手动领取/自动领取等十几种组合。在保证输入的数据结构是之前约定的数据结构的前提下，这个券模型可以解析出来配置的券数据，避免重复开发。
    券模型可以分成三部分：各个模块组件原子化的结构，使用时灵活拼接、用户点击行为和展示逻辑区分，避免代码过度耦合、底层架构上的埋点、异常上报、线上问题、领取失败处理等逻辑统一管理。这样首先是保证日常的新券可以不用前端开发，只跟着测试回归即可。其次换人进行更新迭代可以找到改动的那部分，只改动对应的代码，降低代码理解和维护成本。
#### 性能优化
    性能优化上，先后上线了webview热启动、券数据改由客户端在进直播间4秒后请求，并把数据拼在url上来减少前端请求数据时间、资源内置、资源预载（只在大型活动期间使用）、首屏动画降级展示等方案

#### 监控
    背景：直播的业务具有很强的实时性，对异常的感知和处理比其他业务要更紧急，早期小红书前端架构团队还没有这方面的规划，我就当成一个技术需求做了一个简易的前端异常监控
    两部分：上报sdk、可视化的数据查询后台
    主要核心功能包括：采集、上报、存储、可视化、报警
    主要采集四种类型的信息：错误、性能、通用、异常行为。最重要的上报错误分为js运行时错误、promise错误、资源加载错误、http异常、业务框架错误、自定义异常
#### 采集
    window.addEventListener('error', callback)方法
    window.onerror
    unhandledrejection事件（针对Promise未处理的拒绝）

#### 上报策略
    sendBeacon：‌Navigator.sendBeacon‌是一个用于在浏览器后台发送异步请求的API，特别适用于在页面卸载或关闭时发送数据，如日志记录、用户行为分析等。它确保数据在页面卸载时能够可靠地发送到服务器，而不会阻塞页面的卸载或关闭流程‌
    在没有使用 sendBeacon 的情况下，开发者通常会使用以下方法处理数据上报：fetch和xhr
    ‌同步 XMLHttpRequest‌：这会阻塞主线程，影响用户体验‌
    ‌创建 <img> 元素‌：通过设置 src 属性来延迟页面卸载，但会影响下一页面的加载‌
    数据上报遵循以下规则：
1. 数量阈值触发：
- 当队列中的数据量达到 `batchSize` 时，立即触发上报
- 上报后队列清空
2. 定时上报：
- 每隔 `flushInterval` 毫秒，自动上报队列中的所有数据
- 上报后队列清空
3. Web 环境特有的触发时机：
- 页面关闭前（beforeunload 事件）
- 页面隐藏时（visibilitychange 事件）

#### 可视化
    接口使用sql查询数据，后端提供统一接口和sql，前端处理数据
#### 告警
    根据告警规则（忽略部分错误、设置阈值）使用企业微信、邮件等通知责任人

## 最近在看什么书
    react的社区里的一些库，例如react-query。在B端需求中，正常实现需求的思想都是操作请求和返回数据，点击查询按钮后根据选的值搜索查询。他提供了错误处理和重试、缓存返回值、减少不必要的渲染、自动轮询

## 自我介绍
    我叫杜成恒，18年毕业于哈尔滨理工大学，上一家公司是21年入职小红书，在直播技术组，主要负责小红书直播电商方向的业务，工作内容在移动端看包括常驻的直播间券、带货榜、直播间内游戏、日常营销活动、每年双十一618春节的大型活动、与带货相关的一些基础组件封装等。从Pc端视角来看负责从0到1搭建了主播的一站式带货服务平台直播管理平台，为主播提供开播前广告投放、选品备货、发笔记预告、商品排序的准备工作，开播中的上下架、置顶、实时数据大屏、发红包发券等操作，开播后的数据复盘、群聊、充值等功能。最近三年在写vue，之前写过一些react，react写到hooks，vue写到vue3.

## vue 和 react 区别
### 语法和模板
    Vue 使用基于 HTML 的模板语法，允许开发者声明式地将 DOM 绑定到底层 Vue 实例的数据。模板语法简洁直观，易于学习和上手，对于有 HTML 和 CSS 基础的开发者来说很友好。
    React 使用 JSX（JavaScript XML），它是一种 JavaScript 的语法扩展，允许在 JavaScript 代码中编写类似 XML 的结构。JSX 将 HTML 和 JavaScript 紧密结合，使得代码更加灵活，但对于初学者来说可能有一定的学习曲线
### 响应式原理
    Vue
    Object.defineProperty()（Vue 2）和 Proxy（Vue 3）：Vue 2 使用 Object.defineProperty() 来实现数据的响应式，通过劫持对象属性的 getter 和 setter 来追踪数据的变化。Vue 3 则采用了 Proxy 对象，它可以对整个对象进行代理，解决了 Object.defineProperty() 的一些局限性，如无法检测对象属性的新增和删除等问题。
    React
    React 使用不可变数据的概念，当需要更新数据时，不会直接修改原始数据，而是创建一个新的数据副本。在类组件中使用 setState() 方法来更新状态，在函数组件中使用 useState() 钩子。每次调用 setState() 或更新 useState() 返回的状态时，React 会重新渲染组件。
### 组件化开发
    Vue
    单文件组件（SFC）：Vue 推荐使用单文件组件（.vue 文件），将组件的模板、脚本和样式封装在一个文件中，使得组件的结构清晰，易于维护和管理。
    React
    函数组件和类组件：React 支持函数组件和类组件两种形式。函数组件是无状态的，主要用于展示 UI；类组件可以有自己的状态和生命周期方法。在 React Hooks 出现后，函数组件也可以使用状态和副作用等功能，逐渐成为主流的组件形式。
### 性能优化
    Vue
    虚拟 DOM 和响应式系统：Vue 的虚拟 DOM 算法和响应式系统在性能上表现良好，能够高效地更新 DOM。Vue 还提供了一些性能优化的指令，如 v-if 和 v-show 用于条件渲染，v-for 用于列表渲染时的优化。
    React
    可以通过 shouldComponentUpdate() 生命周期方法（类组件）或 React.memo() 高阶组件（函数组件）来控制组件的重新渲染，从而优化性能。此外，React 还提供了 useMemo() 和 useCallback() 钩子来缓存计算结果和函数，减少不必要的计算。

